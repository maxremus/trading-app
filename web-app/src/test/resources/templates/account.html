<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="bg">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª | TradingApp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f5f7fb;
        }
        .account-container {
            max-width: 900px;
            margin-top: 40px;
        }
        .card {
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .section-title {
            font-weight: 600;
            margin-bottom: 15px;
        }
        .label-muted {
            font-size: 0.9rem;
            color: #6c757d;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
    <div class="container">
        <a class="navbar-brand fw-bold" th:href="@{/dashboard}">üíº TradingApp</a>
        <div class="collapse navbar-collapse justify-content-end">
            <ul class="navbar-nav align-items-center">
                <li class="nav-item me-3">
                    <a class="nav-link" th:href="@{/orders}">–ü–æ—Ä—ä—á–∫–∏</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link" th:href="@{/products}">–ü—Ä–æ–¥—É–∫—Ç–∏</a>
                </li>
                <li class="nav-item me-3">
                    <a class="nav-link active" th:href="@{/account}">–ú–æ—è—Ç –ø—Ä–æ—Ñ–∏–ª</a>
                </li>
                <li class="nav-item">
                    <form th:action="@{/logout}" method="post" style="display:inline;">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="btn btn-outline-light btn-sm">üö™ –ò–∑—Ö–æ–¥</button>
                    </form>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container account-container">

    <!-- –°—ä–æ–±—â–µ–Ω–∏—è –∑–∞ —É—Å–ø–µ—Ö -->
    <div th:if="${success}" class="alert alert-success text-center">
        <span th:text="${success}"></span>
    </div>

    <!-- –û–±—â–∏ –≥—Ä–µ—à–∫–∏ –æ—Ç update -->
    <div th:if="${error}" class="alert alert-danger text-center">
        <span th:text="${error}"></span>
    </div>

    <!-- –ì—Ä–µ—à–∫–∏ –ø—Ä–∏ —Å–º—è–Ω–∞ –Ω–∞ –ø–∞—Ä–æ–ª–∞ -->
    <div th:if="${passError}" class="alert alert-danger text-center">
        <span th:text="${passError}"></span>
    </div>

    <div class="row g-4">

        <!-- –õ—è–≤–∞ –∫–∞—Ä—Ç–∞: –û—Å–Ω–æ–≤–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –ø—Ä–æ—Ñ–∏–ª–∞ -->
        <div class="col-lg-5">
            <div class="card p-4">
                <h4 class="mb-3">üë§ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</h4>

                <p class="mb-1 label-muted">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ</p>
                <p class="fw-semibold" th:text="${user.username}">username</p>

                <p class="mb-1 label-muted">–ò–º–µ–π–ª</p>
                <p class="fw-semibold" th:text="${user.email}">example@mail.com</p>

                <p class="mb-1 label-muted">–†–æ–ª—è</p>
                <span class="badge bg-primary" th:text="${user.role}">USER</span>

                <hr class="my-3">

                <a th:href="@{/dashboard}" class="btn btn-outline-secondary w-100">‚Üê –ù–∞–∑–∞–¥ –∫—ä–º —Ç–∞–±–ª–æ—Ç–æ</a>
            </div>
        </div>

        <!-- –î—è—Å–Ω–∞ —á–∞—Å—Ç: —Ñ–æ—Ä–º–∏ –∑–∞ —Ä–µ–¥–∞–∫—Ü–∏—è -->
        <div class="col-lg-7">
            <div class="card p-4 mb-4">
                <h4 class="section-title">‚úèÔ∏è –†–µ–¥–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ—Ñ–∏–ª</h4>

                <form th:action="@{/account/update}"
                      th:object="${profile}"
                      method="post">

                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                    <div class="mb-3">
                        <label class="form-label">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ</label>
                        <input type="text" th:field="*{username}" class="form-control"
                               placeholder="–í—ä–≤–µ–¥–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—Å–∫–æ –∏–º–µ">
                        <div class="text-danger small" th:if="${#fields.hasErrors('username')}"
                             th:errors="*{username}"></div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–ò–º–µ–π–ª</label>
                        <input type="email" th:field="*{email}" class="form-control"
                               placeholder="–í—ä–≤–µ–¥–∏ –∏–º–µ–π–ª">
                        <div class="text-danger small" th:if="${#fields.hasErrors('email')}"
                             th:errors="*{email}"></div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-success">üíæ –ó–∞–ø–∞–∑–∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ</button>
                    </div>
                </form>
            </div>

            <div class="card p-4">
                <h4 class="section-title">üîí –°–º—è–Ω–∞ –Ω–∞ –ø–∞—Ä–æ–ª–∞</h4>

                <form th:action="@{/account/change-password}"
                      th:object="${passwordDto}"
                      method="post">

                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                    <div class="mb-3">
                        <label class="form-label">–¢–µ–∫—É—â–∞ –ø–∞—Ä–æ–ª–∞</label>
                        <input type="password" th:field="*{oldPassword}" class="form-control"
                               placeholder="–í—ä–≤–µ–¥–∏ —Ç–µ–∫—É—â–∞—Ç–∞ –ø–∞—Ä–æ–ª–∞">
                        <div class="text-danger small" th:if="${#fields.hasErrors('oldPassword')}"
                             th:errors="*{oldPassword}"></div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–ù–æ–≤–∞ –ø–∞—Ä–æ–ª–∞</label>
                        <input type="password" th:field="*{newPassword}" class="form-control"
                               placeholder="–í—ä–≤–µ–¥–∏ –Ω–æ–≤–∞ –ø–∞—Ä–æ–ª–∞">
                        <div class="text-danger small" th:if="${#fields.hasErrors('newPassword')}"
                             th:errors="*{newPassword}"></div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">–ü–æ—Ç–≤—ä—Ä–¥–∏ –Ω–æ–≤–∞—Ç–∞ –ø–∞—Ä–æ–ª–∞</label>
                        <input type="password" th:field="*{confirmPassword}" class="form-control"
                               placeholder="–ü–æ–≤—Ç–æ—Ä–∏ –Ω–æ–≤–∞—Ç–∞ –ø–∞—Ä–æ–ª–∞">
                        <div class="text-danger small" th:if="${#fields.hasErrors('confirmPassword')}"
                             th:errors="*{confirmPassword}"></div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-warning">üîê –°–º–µ–Ω–∏ –ø–∞—Ä–æ–ª–∞—Ç–∞</button>
                    </div>
                </form>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
